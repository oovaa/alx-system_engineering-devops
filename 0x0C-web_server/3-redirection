#!/usr/bin/env bash
# This script installs nginx, configures it to display 'Hello World!', and sets up a redirect for /redirect_me

# Update the package lists for upgrades and new package installations
apt-get update -y -qq

# Install nginx
apt-get install nginx -y

# Start nginx service
service nginx start

# Create a new index.html file with 'Hello World!'
echo 'Hello World!' >/var/www/html/index.html

# Add redirect rule to the existing nginx configuration if it doesn't exist
if ! grep -q "location /redirect_me" /etc/nginx/sites-available/default; then
    sed -i '11i\    location /redirect_me {\n        return 301 https://www.youtube.com/watch?v=QH2-TGUlwu4;\n    }' /etc/nginx/sites-available/default
fi

# Restart nginx
service nginx restart
